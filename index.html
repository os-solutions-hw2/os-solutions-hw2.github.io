
<html>
<head>
<title>Homework: bootstrap and x86 assembly</title>
<link rel="stylesheet" href="../labs.css" type="text/css" />
</head>
<body>

<h2><a href="..">Operating Systems</a></h2>
<hr>

<h1>Homework: bootstrap and x86 assembly</h1>

(total 14 marks)

<p>
1.1 The ROM BIOS (1 marks)
<pre>
[f000:fff0]    0xffff0: ljmp   $0xf000,$0xe05b
[f000:e05b]    0xfe05b: cmpl   $0x0,%cs:0x6c48
[f000:e062]    0xfe062: jne    0xfd2e1
[f000:e066]    0xfe066: xor    %dx,%dx
[f000:e068]    0xfe068: mov    %dx,%ss
[f000:e06a]    0xfe06a: mov    $0x7000,%esp
[f000:e070]    0xfe070: mov    $0xf3691,%edx
[f000:e076]    0xfe076: jmp    0xfd165
</pre>

<p>
1.2 The Boot Loader (2 mark)
<pre>
Before ljmp in bootasm.S: cs=0x0, eip = 0x7c2c (1 mark)
After ljmp in bootasm.S: cs=0x8, eip = 0x7c31 (1 mark)
</pre>

<p>
1.3 Pointers in C (2 marks)
<pre>
Before:
c8 00 00 00 90 01 00 00 2d 01 00 00 2e 01 00 00 (1 mark)
After:
c8 00 00 00 90 f4 01 00 00 01 00 00 2e 01 00 000 (1 mark)
</pre>

<p>
1.4 Loading the Kernel (2 marks)<br>
They are different because the kernel has been loaded at 0x100000 by
the loader. (1 marks)<br>
At 0x100000 lives the "text" (or code) section of the kernel. (1 mark)
<br>

<p>
Variable naming. (3 marks) <br>


<p>
Caller and callee save registers (3 marks).<br>
Basically the compiler should try and use callee-saved registers
first in the caller; and vice-versa. Roughly half-half split ensures
fairness across caller and callee.

<p>
Fastest implementation while respecting calling conventions (2 marks).<br>
<code>jmp _g</code><br>
<code>call _g; ret</code> (1.5 marks)

<p><b>Assignment: fork, caching, and file-descriptor inheritance</b>
<pre>
n=0   0
  1   2
  2   6
  3   14

T(n) = 2*(1 + T(n-1))
</pre>
When you use printf(), the output does not immediately go to the OS, but gets <em>cached</em> in the user process's address-space. On fork, the cache gets duplicated, and so more stuff eventually gets flushed out to the OS. You can fix this by doing fflush(stdout) after every printf() (to flush the user-level cache), and you will get the same answer as when using the write() syscall directly.
<p><hr><p>
</body>
</html>
